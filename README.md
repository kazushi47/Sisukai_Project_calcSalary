# Sisukai_Project_calcSalary
## 概要
システム開発の授業で行っている開発プロジェクトに使用する給与計算クラス等をまとめたもの。

## ファイル説明
- `src/CalcSalary.java` -> 給与計算クラス本体。本番環境にインポートするものはこれのみ。
- `src/DBconnect.java` -> 本番環境にあるデータベース接続用クラス。テスト駆動用。
- `src/SampleMain.java` -> テスト駆動用のメインクラス。これを実行するとテストできる。
- `/Databese.accdb` -> 本番環境にあるAccessデータベース。テスト駆動用。
- `/.vscode/setting.json` -> VSCodeプロジェクト設定ファイル。テスト駆動用。

従って、本番環境に使用するものは`src/CalcSalary.java`のみでその他はテスト駆動用である。

## 給与計算クラスの説明
前項で記述した通り`src/CalcSalary.java`が給与計算クラスでありこれを本番環境にインポートすることにより使用できる。  
  
ではこの給与計算クラスの仕様を説明する。  

| 呼び出し可能なメソッド                                                    | 仕様                                                                                                                                                                                                                                                                                                                                           | 
| :-----------------------------------------------------------------------: | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | 
| CalcSalary(int DIV_ID, String START_DATE, String END_DATE)                | コンストラクタ。<br>当クラスを使用するにはこのコンストラクタを使用しインスタンス化する必要がある。<br>- DIV_ID 給与計算対象部署ID<br>- START_DATE 給与計算対象期間の開始日("yyyy-mm-dd"の形の文字列)<br>- END_DATE 給与計算対象期間の終了日("yyyy-mm-dd"の形の文字列)<br>スローする例外<br>SQLException - データベースのSalaryテーブル接続例外 | 
| void executeCalc(boolean isFirstCalc)                                     | 対象部署・期間の給与計算を実行し、結果をデータベースに格納するにはこれを呼び出す。<br>- isFirstCalc 最初の給与計算の場合はTrueに設定する。2回目以降の再計算の場合はFalseに設定する。<br>スローする例外<br>SQLException - データベース取得・登録時に発生する例外                                                                                | 
| void calculate()                                                          | 対象部署・期間の給与計算を実行する。<br>但しデータベースには一切格納しないため、データベースを更新せずに計算結果だけを確認したい場合にはこれを呼び出す。<br>スローする例外<br>SQLException - データベース取得時に発生する例外                                                                                                                  | 
| int calcXXX(int empId)<br>※ XXXは略でありAgeSalary等の項目名が当てはまる | XXXに当てはまる項目の給与計算を実行し、給与などの値を返却する。<br>データベースの更新は行わない。<br>「年齢給は？？？円」というように値だけが欲しい場合はこれらのメソッドを呼び出す。<br>empId 対象社員ID<br>スローする例外<br>SQLException - データベース取得時に発生する例外                                                                 | 
  
詳しくはJavaDocを参照。  
  
一番単純かつオーソドックスな使い方は以下の通り。  

```java:SampleMain.java
/* 部署IDが1の部署の社員で期間が2020/11/21~2020/12/20の給与を計算するためのCalcSalaryインスタンスを準備 */
CalcSalary calcSalary = new CalcSalary(1, "2020-11-21", "2020-12-20");

/* 給与計算を実行(初回なのでパラメータはtrueにする) */
calcSalary.executeCalc(true);
```

## エラーが出る場合の確認事項と対処法
- 推奨環境にあるかどうか？
  - 特にUCanAccessのjarをプロジェクトで指定する必要がある。
- `DBconnect.java`で指定するAccessデータベースのパスが合っているかどうか？
- コンストラクタに指定するパラメータの書式が異なっていないか？
- 初回の計算時にexeCalc()のパラメータがtrueになっているか？ or 2回目以降の再計算時にexeCalc()のパラメータがfalseになっているか？
- 計算処理の実行時にAccessデータベースファイルをAccessで開いていないかどうか？
  - 場合によってはデータベースをロックされてしまい、適切に処理ができないことがある。
- 計算処理後の結果がデータベースに反映されない。
  - Accessの仕様上、すぐには反映されないため少々時間を置く必要がある。
  - Accessデータベースに計算対象の出退勤などのデータがそもそも存在するか？
- それでもエラーが発生する。
  - 不具合や未実装の可能性があるので報告する。

## 既知の不具合や未実装
[Issues](https://github.com/kazushi47/Sisukai_Project_calcSalary/issues)に現時点での不具合や未実装部分を上げている。  
この他に不具合があることを発見された場合には報告をお願いします。  

## ライセンス・利用規約
当リポジトリ内の外部での利用を禁じます。
